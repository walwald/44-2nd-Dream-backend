# 44-2nd-Dream-backend ê²½ë§¤ í”Œë«í¼ ì œì‘ í”„ë¡œì íŠ¸

ë°•ì„¸ìµ<br>
ì¥ë‹¤í¬([**Github**](https://github.com/walwald), [íšŒê³ ë¡](https://walwaldev.tistory.com/57))<br>
ê¹€ë¯¼ì„œ<br>
ì†¡ì„ì¤€<br>
<br>
> **ìœ„ì½”ë“œ 44ê¸° 2ì°¨ í”„ë¡œì íŠ¸ <br>
c2c ëª…í’ˆ ê²½ë§¤ ê±°ë˜ í”Œë«í¼ KREAMì„ ëª¨ë¸ë§í•˜ì—¬ ë ˆê³  ìƒí’ˆ c2c ê²½ë§¤ ê±°ë˜ í”Œë«í¼ ì›¹ì‚¬ì´íŠ¸ ì œì‘<br>
[ê²°ê³¼ë¬¼ ì‹œì—° ì˜ìƒ ë§í¬](https://www.youtube.com/watch?v=UFuS91VcVp8)**

> **ì§§ì€ í”„ë¡œì íŠ¸ ê¸°ê°„ë™ì•ˆ ê°œë°œì— ì§‘ì¤‘í•´ì•¼ í•˜ë¯€ë¡œ ë””ìì¸/ê¸°íš ë¶€ë¶„ë§Œ í´ë¡ í–ˆìŠµë‹ˆë‹¤.<br>
ê°œë°œì€ ì´ˆê¸° ì„¸íŒ…ë¶€í„° ì „ë¶€ ì§ì ‘ êµ¬í˜„í–ˆìœ¼ë©°, ì•„ë˜ ë°ëª¨ ì˜ìƒì—ì„œ ë³´ì´ëŠ” ë¶€ë¶„ì€ ëª¨ë‘ ë°±ì•¤ë“œì™€ ì—°ê²°í•˜ì—¬ ì‹¤ì œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ ìˆ˜ì¤€ìœ¼ë¡œ ê°œë°œí•œ ê²ƒì…ë‹ˆë‹¤.*


## ğŸ“í”„ë¡œì íŠ¸ ê¸°ê°„ & ì¸ì›
* í”„ë¡œì íŠ¸ ê¸°ê°„: 2ì£¼ (2023.04.20 ~ 2023.05.04)   
* ê°œë°œ ì¸ì›:  
  `Frontend`: ìµœì„ ì˜(Product Manager), ê¹€ì˜ìš´, ì¡°ê±´í˜¸ <br>
  `Backend`: ë°•ì„¸ìµ(Project Manager), ì¥ë‹¤í¬, ê¹€ë¯¼ì„œ, ì†¡ì„ì¤€ <br>
* [í”„ë¡ íŠ¸ì—”ë“œ Github ì €ì¥ì†Œ](https://github.com/wecode-bootcamp-korea/44-2nd-Dream-frontend)
* ëª¨ë¸ë§í•œ ì‚¬ì´íŠ¸: [KREAM](https://kream.co.kr/)

<br>


## ğŸ“ì‚¬ìš© ê¸°ìˆ 

* BackEnd   

 |JavaScript|Node.js|Jest|MySql|Rest|Prettier|Docker|AWS|
|---|---|---|---|---|---|---|---|
|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/js-icon.svg" alt="icon" width="65" height="65" /></div>| <div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/nginx-icon.svg" alt="icon" width="65" height="65" /></div>|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/jest-icon.svg" alt="icon" width="65" height="65" /></div>|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/mysql-icon.svg" alt="icon" width="65" height="65" /></div>|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/restapi-icon.svg" alt="icon" width="65" height="65" /></div>|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/prettier-icon.svg" alt="icon" width="65" height="65" /></div>|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/docker-icon.svg" alt="icon" width="65" height="65" /></div>|<div style="display: flex; align-items: flex-start;"><img src="https://techstack-generator.vercel.app/aws-icon.svg" alt="icon" width="65" height="65" /></div>|
<br>

* í˜‘ì—… <br><br>

<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white"> <br>
<img src="https://img.shields.io/badge/trello-0055cc?style=for-the-badge&logo=trello&logoColor=yellow"> <br>
<img src="https://img.shields.io/badge/Postman-FF6C37?style=for-the-badge&logo=Postman&logoColor=white"> <br>
<img src="https://img.shields.io/badge/slack-4A154B?style=for-the-badge&logo=Slack&logoColor=wihte"> <br>
<img src="https://img.shields.io/badge/notion-000000?style=for-the-badge&logo=notion&logoColor=white"> <br>
<br>


 ## ğŸ“[ERD](https://dbdiagram.io/d/64426bdf6b31947051f9b394)
 > Userê°€ êµ¬ë§¤ìì´ì íŒë§¤ìê°€ ë  ìˆ˜ ìˆìœ¼ë©°, í•˜ë‚˜ì˜ Productì— êµ¬ë§¤ ì…ì°°ê³¼ íŒë§¤ ì…ì°°ì´ ë™ì‹œì— ì´ë£¨ì–´ì§„ë‹¤ëŠ” ì ì— ì£¼ì•ˆì ì„ ë‘ê³  ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ì„ êµ¬ì¶•í•˜ì˜€ìŠµë‹ˆë‹¤. <br><br>
![DREAM (3)](https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/120387100/b18561e6-0888-4aaa-8eaa-452122d73e11)


 ## ğŸ“[Postman](https://documenter.getpostman.com/view/26858291/2s93eWzskR)
> Postmanì˜ Documentationì„ í”„ë¡œì íŠ¸ ì§„í–‰ ì‹œ í”„ë¡ íŠ¸ì—”ë“œì™€ì˜ ì†Œí†µ ë° í˜‘ì—… ë„êµ¬ë¡œ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤. <br><br>
<img width="1512" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-05-18 23 35 50" src="https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/120387100/3bff3e11-24d2-495c-81e4-f815da108948"><br>

 <br>
 

 
 ## ğŸ“í•µì‹¬ ê¸°ëŠ¥
 
 > c2c ê²½ë§¤ í”Œë«í¼ìœ¼ë¡œì„œ ê°–ì¶”ì–´ì•¼ í•  í•„ìˆ˜ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„ í•˜ì˜€ìŠµë‹ˆë‹¤.
 
<details>
<summary>í•µì‹¬ ê¸°ëŠ¥ ì„¤ëª… í¼ì¹˜ê¸°</summary>
<div markdown="1">
 
 ### Users
 **íšŒì›ê°€ì…(Kakao Social Login)**<br>
 **ë¡œê·¸ì¸(Kakao Social Login)**

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/acdfa770-73bd-4775-a10a-e924592faed4

 : KaKaoì—ì„œ ì œê³µí•˜ëŠ” APIë¥¼ í™œìš©í•˜ì—¬ user íšŒì› ê°€ì…, ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„
 
 <br>
 
 ***
 
### Products

**ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ & í•„í„°**

![image](https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/120387100/f3ea9ebf-8142-414a-9436-07e7f7494f08)

: query parameterë¡œ í•„í„° ë° ì •ë ¬ ì¡°ê±´ì„ ì „ë‹¬ ë°›ì•„, ê·¸ì— ë”°ë¼ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ì‘ë‹µí•˜ëŠ” API
-  ì¢‹ì•„ìš” ë§ì€ ìˆœ, ì¦‰ì‹œ êµ¬ë§¤ê°€ ìˆœ, ì¦‰ì‹œ íŒë§¤ê°€ ìˆœ, ë¦¬ë·° ìˆœ, í”„ë¦¬ë¯¸ì—„ ê°€ê²© ìˆœìœ¼ë¡œ ì •ë ¬ ê°€ëŠ¥
-  ìƒí’ˆ ì¹´í…Œê³ ë¦¬, ì‚¬ìš© ì—°ë ¹, ë‚œì´ë„ë¡œ í•„í„° ê°€ëŠ¥ 

<br>

**ìƒí’ˆ ìƒì„¸ ì •ë³´** 

![image](https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/120387100/34ac8dc6-1671-44df-92c8-8c3ef5de0c75)

: path parameterë¡œ productIdë¥¼ ì „ë‹¬ ë°›ì•„, í•´ë‹¹í•˜ëŠ” productì˜ ìƒì„¸ ì •ë³´ë¥¼ ì‘ë‹µí•˜ëŠ” API.

- ìƒí’ˆëª…, ëª¨ë¸ë„˜ë²„, ì¹´í…Œê³ ë¦¬, ì¢‹ì•„ìš” ìˆ˜ ë“± ê¸°ë³¸ ì •ë³´ ë¿ë§Œ ì•„ë‹ˆë¼, ì¦‰ì‹œ êµ¬ë§¤ê°€, ì¦‰ì‹œ íŒë§¤ê°€, ìµœê·¼ ê±°ë˜ê°€, í”„ë¦¬ë¯¸ì—„ í¼ì„¼íŠ¸ ë“±ì˜ ê²½ë§¤ê°€ ê´€ë ¨ ë°ì´í„°ë„ í•¨ê»˜ ì „ë‹¬
- ì¦‰ì‹œ êµ¬ë§¤ê°€ëŠ” íŒë§¤ ì…ì°°ëœ ê¸ˆì•¡ ì¤‘ ê°€ì¥ ë‚®ì€ ê¸ˆì•¡
- ì¦‰ì‹œ íŒë§¤ê°€ëŠ” êµ¬ë§¤ ì…ì°°ëœ ê¸ˆì•¡ ì¤‘ ê°€ì¥ ë†’ì€ ê¸ˆì•¡
- ìµœê·¼ ê±°ë˜ê°€ëŠ” ì²´ê²° ê±°ë˜ ì¤‘ ê°€ì¥ ìµœì‹  ê±°ë˜ì˜ ê±°ë˜ ì„±ì‚¬ ê°€ê²©
- í”„ë¦¬ë¯¸ì—„ í¼ì„¼íŠ¸ëŠ” ìƒí’ˆ ë°œë§¤ê°€ì™€ ìµœê·¼ ê±°ë˜ê°€ì˜ ë¹„ìœ¨ë¡œ ê³„ì‚°

<br>

***

 ### Bid

 
 **êµ¬ë§¤ ì…ì°°**
 

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/e8887c3d-0b93-4e28-b57c-53c8156b11bd


 **ì¦‰ì‹œ êµ¬ë§¤**
  

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/0837d058-7d15-4b29-8b2f-5e2a775153c5

 
 **íŒë§¤ ì…ì°°**
 

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/8e57fdb7-82eb-4eeb-8f2c-d52bc1164ace


 **ì¦‰ì‹œ íŒë§¤**
 

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/0de776fd-5559-4882-b4da-bff2eea4cd7d

**ì…ì°° API**

:[ìƒí’ˆ productId, êµ¬ë§¤/íŒë§¤ ì¤‘ í•´ë‹¹í•˜ëŠ” ì…ì°° ìœ í˜•, ì…ì°° ê¸ˆì•¡, ì…ì°° ë§ˆê° ê¸°í•œ]ì„ requestì˜ bodyë¡œ ì „ë‹¬ë°›ì•„ ì…ì°° ë‚´ì—­ì´ ê¸°ë¡ë˜ëŠ” API. 
- userIdëŠ” tokenì˜ payloadì— ì €ì¥ëœ ì •ë³´ë¥¼ ì´ìš©í•¨.
- ì…ì°° ê¸ˆì•¡ì— ë”°ë¼ ì¦‰ì‹œ ê±°ë˜ê°€ ì„±ì‚¬ ë˜ê¸°ë„ í•¨.
- ì¦‰ì‹œ ê±°ë˜ê°€ ì„±ì‚¬ë˜ëŠ” ê²½ìš°, transactionì„ ì‚¬ìš©í•˜ì—¬ [ê±°ë˜ ê±´ ìƒì„±, ì…ì°° ìƒíƒœë¥¼ ë‚™ì°°ë¡œ ë³€ê²½, ê±°ë˜ ìƒëŒ€ë°©ì˜ ì…ì°° ë‚´ì—­ë„ ë‚™ì°° ìƒíƒœë¡œ ë³€ê²½] ë“±ì˜ ì²˜ë¦¬ê°€ ë™ì‹œì— ì´ë£¨ì–´ì§€ë„ë¡ í•¨.
- í•´ë‹¹ userì™€ ìƒí’ˆì— ëŒ€í•´ ê¸°ì¡´ ì…ì°° ë‚´ì—­ì´ ì¡´ì¬í•  ê²½ìš° 'ê¸ˆì•¡' í˜¹ì€ 'ì…ì°° ê¸°í•œ'ì´ ë³€ê²½ë˜ë„ë¡ í•˜ì—¬, ì…ì°° ê±´ ìƒì„± ì™¸ì—ë„ ì…ì°° ë‚´ì—­ ì—…ë°ì´íŠ¸ì— ë³¸ APIê°€ ì‚¬ìš©ë  ìˆ˜ ìˆë„ë¡ í•¨.
<br>
 
**ì…ì°° ìƒì„¸ ë‚´ì—­ ì¡°íšŒ API**

: ì…ì°° ê¸ˆì•¡ ë° ê¸°í•œ ì…ë ¥ í›„ ì´ì–´ì§€ëŠ” ê°œì¸ ì •ë³´ ì…ë ¥ í˜ì´ì§€ì—ì„œ ì…ì°° ë‚´ì—­ í™•ì¸ ìš©ìœ¼ë¡œ ìš”ì²­ë˜ëŠ” ì…ì°° ìƒì„¸ ì •ë³´ ì¡°íšŒ API.
- path parameterë¡œ ìƒí’ˆì˜ productIdë¥¼, query parameterë¡œ êµ¬ë§¤/íŒë§¤ ë“±ì˜ ì…ì°° ìœ í˜•ì„ ì „ë‹¬ ë°›ìŒ. userIdëŠ” tokenì˜ payloadì— ì €ì¥ëœ ì •ë³´ë¥¼ ì´ìš©í•¨.
- ê±°ë˜ ì„±ì‚¬ ì—¬ë¶€ì— ë”°ë¼ dealId(ê±°ë˜ Id)ì™€ dealNumber(ê³ ìœ  ê±°ë˜ ë²ˆí˜¸) ì „ë‹¬ ì—¬ë¶€ê°€ ë‹¬ë¼ì§. ê±°ë˜ê°€ ì„±ì‚¬ë˜ì§€ ì•Šê³  ì…ì°°ë§Œ ì™„ë£Œëœ ê²½ìš° null ê°’ìœ¼ë¡œë¡œ ì „ë‹¬.
- ìƒí’ˆì— ëŒ€í•œ ê¸°ë³¸ ì •ë³´ì™€, ì…ì°° ê±´ì˜ Id, ì…ì°° ê¸ˆì•¡, ì…ì°° ê¸°í•œ, ìˆ˜ìˆ˜ë£Œ ê¸ˆì•¡ ë“± ì „ë‹¬í•¨.
 
 
 <br>
 
 ***
 
 ### Search
 
 
https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/072f8bfd-b3f0-483a-9115-a07871b613c1
 
 **ìƒí’ˆ ê²€ìƒ‰**
 
 : ìƒí’ˆ ê²€ìƒ‰ ê¸°ëŠ¥ API
 - keywordì— ìƒí’ˆëª… ë˜ëŠ” basic, building, movie, car ë“±ì˜ ì¹´í…Œê³ ë¦¬ ëª… ê¸°ì… ì‹œ ê²€ìƒ‰ë¨
 
 **ì¸ê¸° ê²€ìƒ‰ì–´**
 :ëˆ„ì  ì¸ê¸°ê²€ìƒ‰ì–´ ì¡°íšŒ API
 - ê²€ìƒ‰ì–´ ë°ì´í„°ë¥¼ ì—­ëŒ€ ê²€ìƒ‰ëŸ‰ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ìƒìœ„ 10ê°œì˜ ê²€ìƒ‰ì–´ ì‘ë‹µ

  <br>
  
 ***

 ### Likes

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/e7475a80-6037-4691-aa5d-7af24bbb8110

**ê´€ì‹¬ìƒí’ˆ ë“±ë¡/ì‚­ì œ**<br>
: ê´€ì‹¬ìƒí’ˆ ë“±ë¡/ì‚­ì œ API
- path parameterë¡œ productIdë¥¼ ë°›ì•„ í•´ë‹¹ ìœ ì €ì˜ ê´€ì‹¬ìƒí’ˆ ìƒì„±
- ë™ì¼í•œ productì™€ ë™ì¼í•œ userì— ëŒ€í•´ APIê°€ ì¬ì‹¤í–‰ë  ê²½ìš° ê´€ì‹¬ìƒí’ˆ ì‚­ì œ <br>

**ê´€ì‹¬ìƒí’ˆ ë¦¬ìŠ¤íŠ¸**<br>
: userë³„ë¡œ ê´€ì‹¬ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¡°íšŒí•˜ëŠ” API
- ê²½ë§¤í”Œë«í¼ì´ê¸° ë•Œë¬¸ì— ì¦‰ì‹œêµ¬ë§¤ê°€ì™€ í•¨ê»˜ ê´€ì‹¬ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ì—¬ì¤Œ

 <br>
 
   ***
 
 ### Reviews

https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/119482288/4a612806-8010-4162-8d5b-fa2b8bff27c5

 **ë¦¬ë·° ê²Œì‹œ**<br>
 
 :ë¦¬ë·°ë¥¼ ê²Œì‹œí•˜ëŠ”ëŠ” API
 - multer-3ì™€ multerë¥¼ ì´ìš©í•˜ì—¬ s3ì— ì‚¬ì§„ì„ ì˜¬ë ¤ ì‚¬ì§„ë¦¬ë·°ë¥¼ ê²Œì‹œ ê°€ëŠ¥í•˜ë„ë¡ í•¨ <br>
 
 **ë¦¬ë·° ì¡°íšŒ**<br>
 : ì‚¬ìš©ìê°€ ì‘ì„±í•œ ë¦¬ë·°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” API
 - productIdë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì œí’ˆì— ëŒ€í•œ ë¦¬ë·°ë¥¼ ê²€ìƒ‰
 - appDataSource ê°œì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ì—¬ reviews í…Œì´ë¸”ì—ì„œ íŠ¹ì • í•„ë“œë¥¼ ì„ íƒí•˜ê³  users ë°review_images í…Œì´ë¸”ê³¼ LEFT JOIN í•¨
 - ì œê³µëœ product_idë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê²°ê³¼ë¥¼ í•„í„°ë§
 - ì¿¼ë¦¬ê°€ ì„±ê³µí•˜ë©´ í•¨ìˆ˜ëŠ” ê²€ìƒ‰ëœ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ê³ , ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° "DATABASE_ERROR" ë©”ì‹œì§€ì™€ í•¨ê»˜ DatabaseErrorê°€ ë°œìƒí•˜ê²Œ í•¨ <br>
 
 **ë¦¬ë·° ìˆ˜ì •**<br>
 : ë¦¬ë·°ë¥¼ ì—…ë°ì´íŠ¸(ìˆ˜ì •)ë¥¼ í•  ìˆ˜ ìˆëŠ” API
 - reviewIdë¥¼ í™•ì¸í•˜ê³ , ì¡´ì¬í•˜ëŠ” reviewIdë¼ë©´ ë¦¬ë·° ìˆ˜ì • ê°€ëŠ¥
 - reviewImgëŠ” ì‚¬ìš©ìê°€ ì´ë¯¸ì§€ë¥¼ ì§€ìš°ê³  ì‹¶ë‹¤ë©´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ s3 í•´ë‹¹ ì´ë¯¸ì§€ì˜ urlì´ ì‚­ì œ ë˜ë„ë¡ êµ¬í˜„í•¨ <br>
 
 **ë¦¬ë·° ì‚­ì œ**<br>
 : ì‚¬ìš©ìê°€ ì‘ì„±í•œ ë¦¬ë·°ë¥¼ ì‚­ì œí•  ìˆ˜ ìˆëŠ” API
 - appDataSource ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ëŠ” queryRunnerë¥¼ ìƒì„±í•˜ì—¬ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë¦¬ë·°ì™€ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•¨
 - í”„ë¡œì„¸ìŠ¤ ì¤‘ì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ í•¨ìˆ˜ëŠ” íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ê³  "DATABASE_ERROR" ë©”ì‹œì§€ì™€ í•¨ê»˜ DatabaseErrorë¥¼ ë°œìƒì‹œí‚´ <br>
  <br>
  
  ***
  
 ### Payment
 ![image](https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/120387100/29151875-568c-4c0c-b3f2-e4600cfbc1e3)

![image](https://github.com/wecode-bootcamp-korea/44-2nd-Dream-backend/assets/120387100/5e3806a3-0a6b-4d89-b17a-339938c1ac92)


**íšŒì› ì£¼ì†Œ ì €ì¥**<br>
: ë°°ì†¡ì§€ë¡œ ì‚¬ìš©ë  íšŒì›ì˜ ì£¼ì†Œ ì €ì¥ API <br>

**íšŒì› ê³„ì¢Œë²ˆí˜¸ & ì¹´ë“œë²ˆí˜¸ ì €ì¥**<br>
: íšŒì›ì˜ ì‹ ê·œ ì…ë ¥ëœ ê³„ì¢Œë²ˆí˜¸/ì¹´ë“œ ë²ˆí˜¸ ì €ì¥ API
- íŒë§¤ ì…ì°° ì ˆì°¨ ì¤‘, userì˜ ì¹´ë“œ ë²ˆí˜¸ ë° ê³„ì¢Œ ë²ˆí˜¸ ì…ë ¥ ê³¼ì •ì—ì„œ ì‹ ê·œ ê³„ì¢Œ/ì¹´ë“œ ë²ˆí˜¸ ë“±ë¡ ì‹œ ì‚¬ìš©ë¨
- userIdëŠ” tokenì˜ payloadì— ì €ì¥ëœ ì •ë³´ë¥¼ ì´ìš©í•¨ <br>

**íšŒì›ë³„ ê³„ì¢Œë²ˆí˜¸/ì¹´ë“œë²ˆí˜¸ ë¦¬ìŠ¤íŠ¸**<br>
:  íšŒì›ë³„ ë“±ë¡ëœ ê³„ì¢Œë²ˆí˜¸/ì¹´ë“œë²ˆí˜¸ ì¡°íšŒ API
- íŒë§¤ ì…ì°° ì ˆì°¨ ì¤‘, userì˜ ê³„ì¢Œ ë²ˆí˜¸/ì¹´ë“œ ë²ˆí˜¸ ì…ë ¥ ê³¼ì •ì—ì„œ ê¸° ì…ë ¥ëœ ì¹´ë“œ ë²ˆí˜¸ listë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê¸°ëŠ¥
- userIdëŠ” tokenì˜ payloadì— ì €ì¥ëœ ì •ë³´ë¥¼ ì´ìš©í•¨ <br>

**ì¦‰ì‹œ êµ¬ë§¤ ê²°ì œ**<br>
: ê±°ë˜ê°€ ì„±ì‚¬ë˜ì—ˆì„ ë•Œ êµ¬ë§¤ìì˜ ê²°ì œ ì§„í–‰ ì‹œ ì‚¬ìš©ë˜ëŠ” API
- 'dealNumber'ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ êµ¬ë§¤ ê±°ë˜ì— ëŒ€í•œ ê²°ì œ ì •ë³´ë¥¼ ê²€ìƒ‰
- buyings í…Œì´ë¸”ì— addressIdë¥¼ ì¶”ê°€í•˜ê³  deals í…Œì´ë¸”ì—ì„œ deal_statusë¥¼ ê²°ì œ ì™„ë£Œë¡œ ë³€ê²½ <br>

**ì¦‰ì‹œ íŒë§¤ ì •ì‚°**<br>
: ê±°ë˜ê°€ ì„±ì‚¬ë˜ì—ˆì„ ë•Œ íŒë§¤ìì˜ ì •ì‚° ì§„í–‰ ì‹œ ì‚¬ìš©ë˜ëŠ” API
- 'dealNumber'ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ íŒë§¤ ê±°ë˜ì— ëŒ€í•œ ê²°ì œ ì •ë³´ ê²€ìƒ‰
- 'product_images', 'sellings' ë° 'deals' í…Œì´ë¸”ì—ì„œ íŠ¹ì • í•„ë“œë¥¼ ì„ íƒí•˜ê³  ì§€ì •ëœ ì—´ì„ ê¸°ë°˜ìœ¼ë¡œ JOINí•˜ëŠ” 'queryRunner'ë¥¼ ì‚¬ìš©í•˜ì—¬ SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰ì‹œí‚´ 
- ì¿¼ë¦¬ëŠ” ì œê³µëœ 'dealNumber'ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê²°ê³¼ë¥¼ í•„í„°ë§í•¨
- ì¿¼ë¦¬ê°€ ì„±ê³µí•˜ë©´ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê³  ê²€ìƒ‰ëœ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ê³  ë ‡ì§€ ì•Šìœ¼ë©´ íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ê³  "DATABASE_ERROR" ë©”ì‹œì§€ì™€ DatabaseErrorë¥¼ ë°œìƒì‹œí‚´ <br>

**êµ¬ë§¤ ì…ì°° ì™„ë£Œ**<br>
: êµ¬ë§¤ ì…ì°° ì™„ë£Œ ì‹œ ì‚¬ìš©ë˜ëŠ” API
- ë°ì´í„°ë² ì´ìŠ¤ì˜ êµ¬ë§¤ ì…ì°°ì— addressIdë¥¼ ì—…ë°ì´íŠ¸í•˜ë„ë¡ ì„¤ê³„
- userId ë° biddingIdë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì˜ buyings í…Œì´ë¸”ì—ì„œ address_idí•„ë“œ ì—…ë°ì´íŠ¸ <br>

**íŒë§¤ ì…ì°° ì™„ë£Œ**<br>
: íŒë§¤ ì…ì°° ì™„ë£Œ ì‹œ ì‚¬ìš©ë˜ëŠ” API
- ë°ì´í„°ë² ì´ìŠ¤ì˜ íŠ¹ì • íŒë§¤ ê±°ë˜ ì…ì°°ì— ëŒ€í•œ ì¹´ë“œ ë° ê³„ì¢Œ ë²ˆí˜¸ IDë¥¼ ì—…ë°ì´íŠ¸í•˜ë„ë¡ ì„¤ê³„
- userId ë° biddingIdë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì˜ sellings í…Œì´ë¸”ì—ì„œ card_number_id ë° account_number_id í•„ë“œë¥¼ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ queryRunnerë¥¼ ì‚¬ìš©í•˜ì—¬ ë‘ ê°œì˜ ë³„ë„ SQL ì¿¼ë¦¬ë¥¼ ì‹¤í–‰ì‹œí‚´
- ì¿¼ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ë©´ í•¨ìˆ˜ëŠ” íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê³ , ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš° íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ê³  "DATABASE_ERROR" ë©”ì‹œì§€ì™€ í•¨ê»˜ DatabaseErrorë¥¼ ë°œìƒì‹œí‚´
  <br>
  
  </div>
</details>

***

 ## ğŸ“í•µì‹¬ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
 **1. ìƒí’ˆ ìƒì„¸ ì •ë³´ í˜¸ì¶œ API - SELECT ì¿¼ë¦¬ë¬¸ì˜ ì˜¤ì‚¬ìš©**
 - ìƒí’ˆ ìƒì œ ì •ë³´ í˜¸ì¶œ API ì‘ì„± í›„ APIê°€ ì˜ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •ì—ì„œ ê° í…Œì´ë¸”ì— ë°ì´í„°ë¥¼ 1ê°œì”©ë§Œ ìƒì„±í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ì—¬, SELECT ë¬¸ ë‚´ suq-queryê°€ 2ê°œ ì´ìƒì˜ rowë¥¼ ë°˜í™˜í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ë°œê²¬í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.
 
    <details>
    <summary>ê¸°ì¡´ ì½”ë“œ</summary>
    <div markdown="1">

    ```JavaScript
    //API/models/productDao.js
    const productDetail = async (productId) => {
      try {
        const [productDetail] = await appDataSource.query(
          `
            SELECT 
                p.name productName,
                p.model_number modelNumber,
                c.name categoryName,
                p.original_price originalPrice,
                pi.url imageUrl,
                pa.age productAge,
                pl.level productLevel,
                (SELECT 
                    b.bid_price
                FROM buyings b
                JOIN deals d
                ON d.buying_id = b.id
                WHERE d.created_at = (SELECT max(created_at) FROM deals)) recentDealPrice,
                (SELECT 
                    bid_price
                FROM sellings
                WHERE bid_price = (SELECT min(bid_price) FROM sellings WHERE bid_status_id = 1)) buyNowPrice,
                (SELECT 
                    bid_price
                FROM buyings
                WHERE bid_price = (SELECT max(bid_price) FROM buyings WHERE bid_status_id = 1)) sellNowPrice,
                (SELECT 
                  COUNT(user_id)
                FROM likes
                GROUP BY product_id) likeCount
            FROM products p
            JOIN categories c ON p.category_id = c.id
            JOIN product_images pi ON p.id = pi.product_id
            JOIN product_ages pa ON p.product_age_id = pa.id
            JOIN product_levels pl ON p.product_level_id = pl.id
            LEFT JOIN buyings b ON b.product_id = p.id
            LEFT JOIN sellings s ON s.product_id = p.id
            LEFT JOIN likes l ON l.product_id = p.id
            WHERE p.id = ?
        `,
          [productId]
        );
        return productDetail;
      } catch (err) {
        err.message = 'DATABASE_ERROR';
        err.statusCode = 400;
        throw err;
      }
    };
    ```
    </div>
    </details>

- github push í›„ ì—ëŸ¬ë¥¼ ì¸ì§€í•˜ê³ , queryë¬¸ì˜ êµ¬ì¡°ë¥¼ ìˆ˜ì •í•˜ì˜€ìŠµë‹ˆë‹¤.
- 'ìµœê·¼ ê±°ë˜ê°€(recent deal price)','ì¦‰ì‹œ êµ¬ë§¤ê°€(buy now price)', 'ì¦‰ì‹œ íŒë§¤ê°€(sell now price)'ì˜ ê²½ìš° ì¬í™œìš©ì„±ì„ ê³ ë ¤í•˜ì—¬ ë³„ë„ì˜ í•¨ìˆ˜ë¡œ ë¶„ë¦¬ì‹œì¼°ìŠµë‹ˆë‹¤.
- APIë¥¼ ì‘ì„±í•  ë•Œì—ëŠ” ë°˜ë“œì‹œ ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ì•¼ í•œë‹¤ëŠ” ì‚¬ì‹¤ì„ ê¹¨ë‹¬ì•˜ìŠµë‹ˆë‹¤.


  <details>
  <summary>ìˆ˜ì •ëœ ì½”ë“œ</summary>
  <div markdown="1">

  - ìƒí’ˆ ìƒì„¸ ì •ë³´ í˜¸ì¶œ í•¨ìˆ˜ ('ìµœê·¼ ê±°ë˜ê°€(recent deal price)','ì¦‰ì‹œ êµ¬ë§¤ê°€(buy now price)', 'ì¦‰ì‹œ íŒë§¤ê°€(sell now price)' ì œì™¸)

  ```JavaScript
  //API/models/productDao.js
  //3ê°€ì§€ ê¸ˆì•¡ ì •ë³´ë¥¼ ì œì™¸í•œ ìƒí’ˆ ë””í…Œì¼ ì •ë³´ í˜¸ì¶œ í•¨ìˆ˜ ìµœì¢… ver.

  const productDetail = async (productId) => {
    try {
      const [productDetail] = await appDataSource.query(
        `
          SELECT 
              p.id productId,
              p.name productName,
              p.model_number modelNumber,
              c.name categoryName,
              p.original_price originalPrice,
              pi.url imageUrl,
              pa.age productAge,
              pl.level productLevel,
              l.likeCount
          FROM products p
          JOIN categories c ON p.category_id = c.id
          JOIN product_images pi ON p.id = pi.product_id
          JOIN product_ages pa ON p.product_age_id = pa.id
          JOIN product_levels pl ON p.product_level_id = pl.id
          LEFT JOIN (SELECT 
              product_id,
              COUNT(id) likeCount
           FROM likes
           GROUP BY product_id) l ON l.product_id = p.id
          WHERE p.id = ?
                `,
        [productId]
      );
      return productDetail;
    } catch (err) {
      throw new DatabaseError('DATABASE_ERROR');
    }
  };

  ```
  <br>

  - 'ìµœê·¼ ê±°ë˜ê°€(recent deal price)','ì¦‰ì‹œ êµ¬ë§¤ê°€(buy now price)', 'ì¦‰ì‹œ íŒë§¤ê°€(sell now price)' ë„ì¶œ ë©”ì„œë“œ

  ```JavaScript
  //API/models/bidDao.js
  const appDataSource = require('./appDataSource');
  const { bidStatusEnum } = require('./enum');
  const { DatabaseError } = require('../utils/error');

  class BidCase {
    constructor(productId, bidType, bidPrice) {
      this.bidType = bidType;
      this.bidPrice = bidPrice;
      this.productId = productId;
      this.counterpart = bidType == 'buying' ? 'selling' : 'buying';
      this.commissionRate = bidType == 'buying' ? 0.02 : 0.05;
      this.table = `${bidType}s`;
      this.counterTable = `${this.counterpart}s`;
      this.minOrMax = this.counterpart == 'selling' ? 'min' : 'max';
      this.appDataSource = appDataSource;
    }

   async nowPriceSetter(productIdValue, table, minOrMax) {
      try {
        const [bidPrice] = await this.appDataSource.query(
          ` 
          SELECT 
              bid_price bidPrice
          FROM ${table}
          WHERE bid_price = (
            SELECT ${minOrMax}(bid_price) 
            FROM ${table} 
            WHERE bid_status_id = ${bidStatusEnum.bid} 
            AND product_id = ${productIdValue}) 
          `
        );

        if (bidPrice == undefined) {
          return null;
        }

        return parseFloat(Object.values(bidPrice));
      } catch (err) {
        throw new DatabaseError('DATABASE_ERROR');
      }
    }

    getBuyNowPrice() {
      return this.nowPriceSetter(this.productId, 'sellings', 'min');
    }

    getSellNowPrice() {
      return this.nowPriceSetter(this.productId, 'buyings', 'max');
    }

    async getNowPrice() {
      return this.nowPriceSetter(
        this.productId,
        this.counterTable,
        this.minOrMax
      );
    }

    async getRecentDealPrice() {
      try {
        const [bidPrice] = await this.appDataSource.query(
          ` 
              SELECT 
                  b.bid_price AS bidPrice
              FROM deals d
              JOIN buyings b ON b.id = d.buying_id
              WHERE d.created_at = 
              (SELECT max(d.created_at) 
              FROM deals 
              JOIN buyings b ON b.id = d.buying_id 
              WHERE b.product_id = ${this.productId}) 
              AND b.product_id = ${this.productId}
              ORDER BY d.created_at DESC
              `
        );

        if (bidPrice == undefined) {
          return null;
        }

        return parseFloat(Object.values(bidPrice));
      } catch (err) {
        throw new DatabaseError('DATABASE_ERROR');
      }
    }
   };
  ```
  <br>

  - ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ í•©í•˜ì—¬ ì „ë‹¬í•˜ëŠ” producService ë‚´ í•¨ìˆ˜

  ```JavaScript
  //API/services/productService.js
  const productDao = require('../models/productDao');
  const { BaseError } = require('../utils/error');
  const { BidCase } = require('../models/bidDao');

  const getProductDetail = async (productId) => {
    const checkProductId = await productDao.isExistingProduct(productId);

    if (!checkProductId) {
      throw new BaseError('PRODUCT_DOES_NOT_EXIST', 404);
    }

    const productDetail = await productDao.productDetail(productId);
    const bidCase = new BidCase(productId);

    productDetail.buyNowPrice = await bidCase.getBuyNowPrice();
    productDetail.sellNowPrice = await bidCase.getSellNowPrice();
    productDetail.recentDealPrice = await bidCase.getRecentDealPrice();
    productDetail.recentDealPrice == null
      ? (productDetail.premiumPercent = null)
      : (productDetail.premiumPercent = (
          ((productDetail.recentDealPrice - productDetail.originalPrice) /
            productDetail.originalPrice) *
          100
        ).toFixed(1));

    return productDetail;
  };
  ```
  </div>
  </details>
  
  <br>
  
 **2. ê²½ë§¤ ì…ì°° API - API classí™”**
 - êµ¬ë§¤ ì…ì°°'ê³¼ 'íŒë§¤ ì…ì°°'ì„ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í•˜ë‚˜ì˜ APIë¥¼ ì‘ì„±í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.
 - ì²˜ìŒì—ëŠ” í•¨ìˆ˜ì™€ ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ í•„ìš”ì‹œ í•¨ìˆ˜ì˜ ì¸ìë¡œ ì ì ˆí•œ ê°’ì„ ê°ì²´ì˜ propertyì—ì„œ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.
 - ê·¸ëŸ¬ë‚˜ ê° ê²½ìš°ì— ë”°ë¼ì„œ ë‹¬ë¼ì ¸ì•¼ ë³€ìˆ˜ê°€ ë§ì•„ ì—¬ëŸ¬ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ê²Œ ë˜ë©´ì„œ ì½”ë“œì˜ ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê³  ë³µì¡ì„±ì´ ë†’ì•„ì§„ë‹¤ê³  íŒë‹¨í•˜ì˜€ìŠµë‹ˆë‹¤.
 - ê³ ì•ˆí•´ë‚¸ ë°©ë²•ì´ classë¥¼ í™œìš©í•˜ì—¬ propertyì™€ ë©”ì„œë“œë¥¼ í•œ ë²ˆì— í™œìš©í•˜ëŠ” ë°©ì•ˆì´ì—ˆìŠµë‹ˆë‹¤.
    <details>
    <summary>ì‘ì„±í•œ ì½”ë“œ</summary>
    <div markdown="1">
      
      - bidDao ë‚´ ì…ì°° ê´€ë ¨ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” class
      
      ```JavaScript
      //API/models/bidDao.js

      class BidCase {
        constructor(productId, bidType, bidPrice = null, dueDate = null, userId) {
          this.bidType = bidType;
          this.bidPrice = bidPrice;
          this.productId = productId;
          this.counterpart = bidType == 'buying' ? 'selling' : 'buying';
          this.commissionRate = bidType == 'buying' ? 0.02 : 0.05;
          this.counterCommissionRate = bidType == 'buying' ? 0.05 : 0.02;
          this.table = `${bidType}s`;
          this.counterTable = `${this.counterpart}s`;
          this.minOrMax = this.counterpart == 'selling' ? 'min' : 'max';
          this.dueDate = dueDate;
          this.userId = userId;
          this.appDataSource = appDataSource;
        }

        async nowPriceSetter(productIdValue, table, minOrMax) {
          try {
            const [bidPrice] = await this.appDataSource.query(
              ` 
              SELECT 
                  bid_price bidPrice
              FROM ${table}
              WHERE bid_price = (
                SELECT ${minOrMax}(bid_price) 
                FROM ${table} 
                WHERE bid_status_id = ${bidStatusEnum.bid} 
                AND product_id = ${productIdValue}) 
              `
            );

            if (bidPrice == undefined) {
              return null;
            }

            return parseFloat(Object.values(bidPrice));
          } catch (err) {
            throw new DatabaseError('DATABASE_ERROR');
          }
        }

        getBuyNowPrice() {
          return this.nowPriceSetter(this.productId, 'sellings', 'min');
        }

        getSellNowPrice() {
          return this.nowPriceSetter(this.productId, 'buyings', 'max');
        }

        async getNowPrice() {
          return this.nowPriceSetter(
            this.productId,
            this.counterTable,
            this.minOrMax
          );
        }

        async getRecentDealPrice() {
          try {
            const [bidPrice] = await this.appDataSource.query(
              ` 
                  SELECT 
                      b.bid_price AS bidPrice
                  FROM deals d
                  JOIN buyings b ON b.id = d.buying_id
                  WHERE d.created_at = 
                  (SELECT max(d.created_at) 
                  FROM deals 
                  JOIN buyings b ON b.id = d.buying_id 
                  WHERE b.product_id = ${this.productId}) 
                  AND b.product_id = ${this.productId}
                  ORDER BY d.created_at DESC
                  `
            );

            if (bidPrice == undefined) {
              return null;
            }

            return parseFloat(Object.values(bidPrice));
          } catch (err) {
            throw new DatabaseError('DATABASE_ERROR');
          }
        }

        async isNowPrice() {
          const nowPrice = await this.getNowPrice();
          if (
            nowPrice &&
            ((this.bidType == 'buying' && this.bidPrice - nowPrice >= 0) ||
              (this.bidType == 'selling' && this.bidPrice - nowPrice <= 0))
          ) {
            this.bidPrice = nowPrice;

            return this.bidPrice;
          }

          return false;
        }

        async isExistingBid() {
          try {
            const [result] = await appDataSource.query(
              `SELECT EXISTS (
                  SELECT
                  id
                  FROM ${this.table}
                  WHERE user_id = ${this.userId} 
                  AND product_id = ${this.productId} 
                  AND bid_status_id = ${bidStatusEnum.bid}
                  ) existing 
                  `
            );
            return !!parseInt(result.existing);
          } catch (err) {
            throw new DatabaseError('DATABASE_ERROR');
          }
        }

        async biddingIn() {
          const queryRunner = this.appDataSource.createQueryRunner();
          await queryRunner.connect();
          await queryRunner.startTransaction();
          try {
            await this.isNowPrice();
            if (await this.isExistingBid()) {
              await queryRunner.query(
                `UPDATE ${this.table}
              SET bid_price = ?,
                  due_date = ?
              WHERE user_id = ? 
              AND product_id = ? 
              AND bid_status_id = ?`,
                [
                  this.bidPrice,
                  this.dueDate,
                  this.userId,
                  this.productId,
                  bidStatusEnum.bid,
                ]
              );

              const [bidding] = await queryRunner.query(
                `SELECT
                  id
              FROM ${this.table}
              WHERE user_id = ${this.userId} 
              AND product_id = ${this.productId} 
              AND bid_status_id = ${bidStatusEnum.bid}
              `
              );
              this.biddingId = bidding.id;
            } else {
              const bidding = await queryRunner.query(
                ` INSERT INTO ${this.table} (
                      product_id,
                      bid_price,
                      due_date,
                      user_id
                      )
                      VALUES (?, ?, ?, ?)`,
                [this.productId, this.bidPrice, this.dueDate, this.userId]
              );

              this.biddingId = bidding.insertId;
            }

            if (!(await this.isNowPrice())) {
              await queryRunner.commitTransaction();
              return;
            }

            const [partner] = await queryRunner.query(
              `SELECT
              id,
              user_id userId 
              FROM ${this.counterTable}
              WHERE updated_at = 
              (SELECT 
                  min(updated_at)
              FROM ${this.counterTable}
              WHERE product_id = ${this.productId} 
              AND bid_price = ${this.bidPrice} 
              AND bid_status_id = ${bidStatusEnum.bid})
              AND product_id = ${this.productId} 
              AND bid_price = ${this.bidPrice} 
              AND bid_status_id = ${bidStatusEnum.bid}
              ORDER BY updated_at`
            );

            if (partner.userId == this.userId) {
              throw new DatabaseError('SAME_USER_WITH_COUNTERPART');
            }

            await queryRunner.query(
              `UPDATE ${this.table} t
              JOIN ${this.counterTable} c
              SET t.bid_status_id = ${bidStatusEnum.deal},
                  c.bid_status_id = ${bidStatusEnum.deal}
              WHERE t.id = ${this.biddingId} 
              AND c.id = ${partner.id}`
            );

            const dealInput = await queryRunner.query(
              ` INSERT INTO deals (
                  ${this.bidType + '_id'},
                  ${this.counterpart + '_id'},
                  ${this.bidType + '_commission'},
                  ${this.counterpart + '_commission'}
                  )
                  VALUES (?, ?, ?, ?)`,
              [
                this.biddingId,
                partner.id,
                this.commissionRate * this.bidPrice,
                this.counterCommissionRate * this.bidPrice,
              ]
            );

            [this.dealInfo] = await queryRunner.query(
              `
              SELECT
                  id,
                  deal_number dealNumber
              FROM deals
              WHERE id = ?`,
              [dealInput.insertId]
            );

            await queryRunner.commitTransaction();

            return;
          } catch (err) {
            await queryRunner.rollbackTransaction();
            err.message = err.message || 'DATABASE_ERROR';
            err.statusCode = 400;
            throw err;
          } finally {
            await queryRunner.release();
          }
        }
      ```
      - bidDaoì˜ classë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” bidService
                                                                          
      ```JavaScript
      //API/services/bidService.js
      const inputBidPrice = async (productId, bidType, bidPrice, dueDate, userId) => {
        const bidCase = new BidCase(productId, bidType, bidPrice, dueDate, userId);

        return await bidCase.biddingIn();
      };
      ``` 
    </div>
    </details>
    
  - classë¥¼ ê¹Šì´ í•™ìŠµí•˜ëŠ” ê³„ê¸°ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.
  
<br>
  
  ***
    
 ## ğŸ“Reference

- ì´ í”„ë¡œì íŠ¸ëŠ” [KREAM](https://kream.co.kr/) ì‚¬ì´íŠ¸ë¥¼ ì°¸ì¡°í•˜ì—¬ í•™ìŠµëª©ì ìœ¼ë¡œ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
- ì‹¤ë¬´ìˆ˜ì¤€ì˜ í”„ë¡œì íŠ¸ì´ì§€ë§Œ í•™ìŠµìš©ìœ¼ë¡œ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— ì´ ì½”ë“œë¥¼ í™œìš©í•˜ì—¬ ì´ë“ì„ ì·¨í•˜ê±°ë‚˜ ë¬´ë‹¨ ë°°í¬í•  ê²½ìš° ë²•ì ìœ¼ë¡œ ë¬¸ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì‚¬ì§„ ëŒ€ë¶€ë¶„ì€ ìœ„ì½”ë“œì—ì„œ êµ¬ë§¤í•œ ê²ƒì´ë¯€ë¡œ í•´ë‹¹ í”„ë¡œì íŠ¸ ì™¸ë¶€ì¸ì´ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
